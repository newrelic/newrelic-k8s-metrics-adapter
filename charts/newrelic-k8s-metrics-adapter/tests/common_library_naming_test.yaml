suite: test naming helpers
templates:
  - templates/configmap.yaml
  - templates/deployment.yaml
  - templates/service.yaml
  - templates/secret.yaml
release:
  name: my-release
  namespace: my-namespace
tests:
  - it: default values has its name correctly defined
    set:
      personalAPIKey: 21321
      config:
        accountID: 11111111
    asserts:
      - equal:
          path: metadata.name
          value: nri-my-release-newrelic-k8s-metrics-adapter

  - it: name of the release is not duplicated
    set:
      personalAPIKey: 21321
      config:
        accountID: 11111111
    release:
      name: newrelic-k8s-metrics-adapter
    asserts:
      - equal:
          path: metadata.name
          value: nri-newrelic-k8s-metrics-adapter

  - it: name of the release is overridable
    set:
      personalAPIKey: 21321
      nameOverride: test
      config:
        accountID: 11111111
    asserts:
      - equal:
          path: metadata.name
          value: nri-my-release-test

  - it: name of the release is overridable with the release name
    set:
      nameOverride: my-release
      personalAPIKey: 21321
      config:
        accountID: 11111111
    asserts:
      - equal:
          path: metadata.name
          value: nri-my-release

  - it: nri- preffix does not duplicate
    set:
      personalAPIKey: 21321
      config:
        accountID: 11111111
    release:
      name: nri-bundle
    asserts:
      - equal:
          path: metadata.name
          value: nri-bundle-newrelic-k8s-metrics-adapter

  - it: full name override
    set:
      personalAPIKey: 21321
      fullnameOverride: fno
      config:
        accountID: 11111111
    asserts:
      - equal:
          path: metadata.name
          value: fno
