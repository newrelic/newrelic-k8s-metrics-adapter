suite: test naming helper for job-createSecret
templates:
  - templates/apiservice/job-patch/job-createSecret.yaml
release:
  name: my-release
  namespace: my-namespace
tests:
  - it: spec metadata name is is correctly defined
    asserts:
      - equal:
          path: spec.template.metadata.name
          value: nri-my-release-newrelic-k8s-metrics-adapter-apiservice-create
  - it: container args are correctly defined
    asserts:
      - equal:
          path: spec.template.spec.containers[0].args
          value:
            - create
            - --host=nri-my-release-newrelic-k8s-metrics-adapter,nri-my-release-newrelic-k8s-metrics-adapter.my-namespace.svc
            - --namespace=my-namespace
            - --secret-name=nri-my-release-newrelic-k8s-metrics-adapter-apiservice
            - --cert-name=tls.crt
            - --key-name=tls.key
  - it: serviceAccountName is correctly defined
    asserts:
      - equal:
          path: spec.template.spec.serviceAccountName
          value: nri-my-release-newrelic-k8s-metrics-adapter-apiservice